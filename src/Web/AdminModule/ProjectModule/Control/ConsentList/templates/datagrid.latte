{extends $originalTemplate}

{varType App\ReadModel\Consent\ConsentListView $item}
{varType App\Domain\GlobalSettings\ValueObject\Environment[] $environments}

{define col-user_identifier}
    <a href="{$linkFactory('openModal!', ['modal' => 'history-' . Ramsey\Uuid\Uuid::fromString($item->id)->getHex()->toString()])}" data-spinner-for="self" class="ajax font-semibold">
        {$item->userIdentifier}
    </a>
{/define}

{define col-settings_short_identifier}
    {if NULL !== $item->settingsShortIdentifier}
        {if NULL !== $item->settingsId}
            <div class="flex justify-between">
                <a id="show-consent-settings-{$item->id}" href="{$linkFactory('openModal!', ['consentSettingsDetail-' . Ramsey\Uuid\Uuid::fromString($item->settingsId)->getHex()->toString()])}" class="ajax text-indigo-700 inline-flex items-center mr-1">
                    {_settingsShortIdentifierValue, ['shortIdentifier' => $item->settingsShortIdentifier]}
                    {svg common/eye.svg, class: 'h-5 w-5 ml-1'}
                </a>
                <div data-spinner-for="show-consent-settings-{$item->id}" class="h-6 w-6"></div>
            </div>
        {else}
            {_settingsShortIdentifierValue, ['shortIdentifier' => $item->settingsShortIdentifier]}
        {/if}
    {/if}
{/define}

{define col-environment}
    {include #environment-badge, code: $item->environment}
{/define}

{define #environment-badge, string|null $code}
    <span class="inline-flex items-center gap-x-1.5 rounded-md px-2 py-1">
        {if null === $code}
            <svg class="h-1.5 w-1.5 fill-white" viewBox="0 0 6 6" aria-hidden="true">
                <circle cx="3" cy="3" r="3" />
            </svg>
            {_//layout.default_environment}
        {elseif isset($environments[$code])}
           <svg class="h-1.5 w-1.5 fill-white" viewBox="0 0 6 6" aria-hidden="true" style="fill: {$environments[$code]->color->value()|noescape}">
                <circle cx="3" cy="3" r="3" />
            </svg>
            {$environments[$code]->name}
        {else}
            <svg class="h-1.5 w-1.5 fill-white" viewBox="0 0 6 6" aria-hidden="true">
                <circle cx="3" cy="3" r="3" />
            </svg>
            {$code}
        {/if}
    </span>
{/define}
